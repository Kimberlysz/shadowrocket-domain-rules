# legacy
  # Best Shadowrocket Rules (https://github.com/h2y/Shadowrocket-ADBlock-Rules)
  # by Moshel
  # build time: 2021-03-29 02:33:16

# now build by kim xie
  # build time: 2023-05-31

[General]
#: means title
##: means remark code

# bypass-system = true
# bypass-tun = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 198.18.0.0/15, 239.255.255.250/32,
# dns-server = 114.114.114.114, 112.124.47.27, 8.8.8.8, 208.67.220.220, 1.0.0.1, https://dns.cloudflare.com/dns-query, https://dns11.quad9.net/dns-query, tls://dns.google, system
# skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, e.crashlytics.com, captive.apple.com

bypass-system = true
ipv6 = true
prefer-ipv6 = false
private-ip-answer = true

# optional: another set rules of "dns-server" and "fallback-dns-server"
dns-server = 233.5.5.5, 119.29.29.29, 114.114.114.114, 180.76.76.76
# dns-server = 114.114.114.114, 112.124.47.27, 1.0.0.1, 8.8.8.8, 208.67.220.220
# fallback-dns-server = https://dns.cloudflare.com/dns-query, https://dns11.quad9.net/dns-query, tls://dns.google, system

# skip-proxy not include the following: e.crashlytics.com, 
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, e.crashlytics.com, captive.apple.com

# tun-excluded-routes added: 198.18.0.0/15, 239.255.255.250/32,
bypass-tun = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 198.18.0.0/15, 239.255.255.250/32,
## tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16,  198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32

always-real-ip = *.lan, *.linksys.com, *.linksyssmartwifi.com, +.aliyun.com, *.aliyun.com, swscan.apple.com, mesu.apple.com, swquery.apple.com, swdownload.apple.com, swcdn.apple.com, swdist.apple.com, +.stun.*.*, +.stun.*.*.*, +.stun.*.*.*.*, +.stun.*.*.*.*.*, +.srv.nintendo.net, *.n.n.srv.nintendo.net, +.stun.playstation.net, +.battlenet.com.cn, +.wotgame.cn, +.wggames.cn, +.wowsgame.cn, +.wargaming.net, *.square-enix.com, *.finalfantasyxiv.com, *.ffxiv.com, *.ff14.sdo.com, ff.dorado.sdo.com, lens.l.google.com, *.msftconnecttest.com, *.msftncsi.com, xbox.*.microsoft.com, xbox.*.*.microsoft.com, +.xboxlive.com, +.music.163.com, +.126.net, musicapi.taihe.com, music.taihe.com, songsearch.kugou.com, trackercdn.kugou.com, *.kuwo.cn, api-jooxtt.sanook.com, api.joox.com, joox.com, +.y.qq.com, +.music.tc.qq.com, aqqmusic.tc.qq.com, +.stream.qqmusic.qq.com, +.xiami.com, +.music.migu.cn, time.*.com, time.*.gov, time.*.edu.cn, time.*.apple.com, time1.*.com, time2.*.com, time3.*.com, time4.*.com, time5.*.com, time6.*.com, time7.*.com, ntp.*.com, ntp.*.com, ntp1.*.com, ntp2.*.com, ntp3.*.com, ntp4.*.com, ntp5.*.com, ntp6.*.com, ntp7.*.com, *.time.edu.cn, *.ntp.org.cn, +.pool.ntp.org, time1.cloud.tencent.com, localhost.ptlogin2.qq.com, localhost.sec.qq.com, proxy.golang.org, +.qq.com, +.baidu.com, +.163.com, +.126.net, +.taobao.com, +.jd.com, +.tmall.com, *.mcdn.bilivideo.cn, +.nvidia.com, +.nvidia.cn, +.nvgs.nvidia.com, +.nvgs.nvidia.cn, shark007.net, xncsi.xboxlive.com, xncsi.xboxlive.cn, *.msftconnecttest.com, *.msftncsi.com, xbox.ipv6.microsoft.com, x1ds.xboxlive.com
## always-reject-url-rewrite = false

# direct domain fail to resolve use proxy rule
## dns-direct-fallback-proxy = true

## dns-direct-system = false
## dns-fallback-system = false
## icmp-auto-reply = true

# The fallback behavior when UDP traffic matches a policy that doesn't support the UDP relay. Possible values: DIRECT, reject.
## udp-policy-not-supported-behaviour = REJECT

[Rule]
PROCESS-NAME,v2ray,DIRECT
PROCESS-NAME,xray,DIRECT
PROCESS-NAME,clash,DIRECT
PROCESS-NAME,naive,DIRECT
PROCESS-NAME,trojan,DIRECT
PROCESS-NAME,trojan-go,DIRECT
PROCESS-NAME,ss-local,DIRECT
PROCESS-NAME,privoxy,DIRECT
PROCESS-NAME,leaf,DIRECT
PROCESS-NAME,Thunder,DIRECT
PROCESS-NAME,DownloadService,DIRECT
PROCESS-NAME,qBittorrent,DIRECT
PROCESS-NAME,Transmission,DIRECT
PROCESS-NAME,fdm,DIRECT
PROCESS-NAME,aria2c,DIRECT
PROCESS-NAME,Folx,DIRECT
PROCESS-NAME,NetTransport,DIRECT
PROCESS-NAME,uTorrent,DIRECT
PROCESS-NAME,WebTorrent,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/private.txt,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/reject.txt,REJECT
RULE-SET,SYSTEM,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/icloud.txt,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/apple.txt,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/google.txt,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/proxy.txt,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/direct.txt,DIRECT
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/telegramcidr.txt,PROXY
RULE-SET,https://cdn.jsdelivr.net/gh/Loyalsoldier/surge-rules@release/ruleset/cncidr.txt,DIRECT
RULE-SET,LAN,DIRECT
FINAL,PROXY,dns-failed

# Appendix
 # WARNING: the following keyword might conflict with relevant websites
  # check those domain rules often

  # a
   # aliyun (clash with)
    # .al
   
  # p
   # pingan bank (clash with)
    # .cl
    # .sd
    # .orange

  # t
   # tld-!cn (geosite, clash with)
   # tld-opennic (geosite, clash with)

[Host]
localhost = 127.0.0.1

[URL Rewrite]
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302

# ^http://(www.)?google.cn https://www.google.com 302
# (?<=_region=)US(?=&) JP 307
# (?<=&mcc_mnc=)4 2 307
# ^(https?:\/\/(tnc|dm)[\w-]+\.\w+\.com\/.+)(\?)(.+) $1$3 302
# (^https?:\/\/*\.\w{4}okv.com\/.+&.+)(\d{2}\.3\.\d)(.+) $118.0$3 302
